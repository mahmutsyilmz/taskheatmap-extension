<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TaskHeatmap</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body class="popup">
    <main class="popup__shell">
      <header class="popup__header">
        <div>
          <h1 class="popup__title">TaskHeatmap</h1>
          <p class="popup__subtitle" id="streak-counter" aria-live="polite"></p>
        </div>
        <button
          id="open-options"
          class="button button--ghost"
          type="button"
          aria-label="Open options"
        >
          <span>Settings</span>
        </button>
      </header>

      <section class="panel panel--controls">
        <div class="segmented" role="tablist" aria-label="Timeframe">
          <button class="segmented__button is-active" role="tab" data-timeframe="day">Day</button>
          <button class="segmented__button" role="tab" data-timeframe="week">Week</button>
          <button class="segmented__button" role="tab" data-timeframe="month">Month</button>
        </div>
        <div class="filter-controls">
          <label class="filter-controls__label" for="activity-filter">Activity</label>
          <div class="segmented" id="activity-filter" role="tablist" aria-label="Activity filter">
            <button class="segmented__button" role="tab" data-filter="active">Active</button>
            <button class="segmented__button is-active" role="tab" data-filter="all">All</button>
            <button class="segmented__button" role="tab" data-filter="idle">Idle</button>
          </div>
        </div>
        <label class="day-select">
          <span class="day-select__label">Anchor date</span>
          <select id="day-select" aria-label="Select a day"></select>
        </label>
      </section>

      <section class="panel panel--chart" aria-label="Activity chart">
        <canvas id="activity-chart" width="320" height="220"></canvas>
        <div id="chart-empty" class="empty-state" hidden>
          <svg
            class="empty-state__illustration"
            viewBox="0 0 120 80"
            role="presentation"
            aria-hidden="true"
          >
            <defs>
              <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#7a7fff" stop-opacity="0.85" />
                <stop offset="100%" stop-color="#50e3c2" stop-opacity="0.85" />
              </linearGradient>
            </defs>
            <rect
              x="12"
              y="18"
              width="96"
              height="54"
              rx="10"
              fill="url(#gradient)"
              opacity="0.12"
            />
            <path
              d="M28 60L44 42l12 14 18-26 18 24"
              stroke="#7a7fff"
              stroke-width="4"
              stroke-linecap="round"
              stroke-linejoin="round"
              fill="none"
              opacity="0.4"
            />
            <circle cx="44" cy="42" r="4" fill="#50e3c2" opacity="0.8" />
            <circle cx="74" cy="30" r="4" fill="#50e3c2" opacity="0.6" />
            <circle cx="92" cy="54" r="4" fill="#50e3c2" opacity="0.6" />
          </svg>
          <p id="chart-empty-message"></p>
        </div>
      </section>

      <section class="panel panel--trend" aria-live="polite" id="trend-summary"></section>

      <section class="panel panel--top" aria-labelledby="top-domains-title">
        <div class="panel__header">
          <h2 id="top-domains-title">Focus highlights</h2>
          <span class="panel__subtext" id="total-duration"></span>
        </div>
        <ol id="top-domain-list" class="top-domains" data-empty="true"></ol>
      </section>

      <section class="panel panel--table">
        <div class="panel__header">
          <h2>Breakdown</h2>
          <div class="export-buttons">
            <button id="export-json" class="button button--ghost" type="button">Export JSON</button>
            <button id="export-csv" class="button" type="button">Export CSV</button>
          </div>
        </div>
        <div class="table-wrapper">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">Domain</th>
                <th scope="col" class="table__numeric">Active</th>
                <th scope="col" class="table__numeric">Idle</th>
                <th scope="col" class="table__numeric">Total</th>
              </tr>
            </thead>
            <tbody id="domain-rows"></tbody>
          </table>
        </div>
      </section>

      <section class="panel panel--actions">
        <button id="clear-data" class="button button--danger" type="button">Clear data</button>
        <p id="status-message" class="status" role="status" aria-live="polite"></p>
      </section>
    </main>

    <div
      id="confirm-modal"
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="confirm-title"
      hidden
    >
      <div class="modal__content">
        <h2 id="confirm-title">Remove all tracked data?</h2>
        <p>This action cannot be undone and will reset your heatmap.</p>
        <div class="modal__actions">
          <button id="confirm-cancel" class="button button--ghost" type="button">Cancel</button>
          <button id="confirm-accept" class="button button--danger" type="button">
            Yes, clear everything
          </button>
        </div>
      </div>
    </div>

    <script type="module" src="popup.js"></script>
  </body>
</html>
